<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tutor Académico UC - Búsqueda de Cursos</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/search.css">
    <link rel="stylesheet" href="css/browse.css">
    <link rel="stylesheet" href="css/results.css">
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/modal.css">
    <link rel="stylesheet" href="css/chat.css">
    <link rel="stylesheet" href="css/course.css">
    <!-- Legacy CSS files removed -->
    <!--Añadir Font Awesome para que se vean los íconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Añadir Favicon para el ícono de la pestaña -->
    <link rel="icon" href="assets/logo.png" type="image/png">
    <!-- Los estilos del chat se cargan dinámicamente -->
</head>

<body>
    <header class="main-header">
        <div class="header-start">
            <div class="logo">
                <img src="/assets/logo.png" alt="Logo UC" class="logo-img">
                <span class="logo-text">Tutor Académico</span>
            </div>
            <button id="header-back-btn" class="header-back-btn hidden">
                <i class="fas fa-arrow-left"></i> <span>Volver</span>
            </button>
        </div>
        <div class="header-nav">
            <a href="#" class="nav-link nav-home-button" title="Ir al inicio">
                <i class="fas fa-home"></i>
            </a>
            <div id="user-session-controls">
                <!-- Estado de carga inicial -->
                <span class="loading-user">Cargando...</span>
            </div>
        </div>
    </header>

    <div class="hero-wrapper">
        <div class="hero-wrapper">
            <section class="hero">
                <div class="hero-content">
                    <h1 class="hero-title">Tu Hub Académico <span class="highlight-text">Inteligente</span></h1>
                    <p class="hero-subtitle">
                        Potencia tu aprendizaje con acceso instantáneo a recursos, libros y un tutor IA personalizado
                        disponible 24/7.
                    </p>
                    <ul class="hero-features">
                        <li><i class="fas fa-book-open"></i> Biblioteca Digital</li>
                        <li><i class="fas fa-robot"></i> Tutor IA Personal</li>
                        <li><i class="fas fa-check-circle"></i> Recursos Académicos</li>
                    </ul>
                </div>
            </section>

            <section class="search-section">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="Buscar por curso, temas y libro...">
                    <button id="searchButton" class="btn-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                            viewBox="0 0 16 16">
                            <path
                                d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
                        </svg>
                        Buscar
                    </button>
                </div>
            </section>
        </div>

        <div class="main-container">

            <div id="content-container">
                <nav id="breadcrumbs" class="breadcrumbs hidden" aria-label="breadcrumb"></nav>
                <div id="browse-container"></div>
                <div id="results-container" class="hidden"></div>
            </div>
        </div>

        <!-- MODAL DE INVITACIÓN PARA FUNCIONES PROTEGIDAS -->
        <div id="login-prompt-modal" class="modal modal-overlay" style="display: none;">
            <div class="modal-content auth-prompt-modal">
                <div class="modal-header">
                    <h2>Acceso Exclusivo para Miembros</h2>
                    <button class="modal-close-btn modal-close" id="login-prompt-close-btn">×</button>
                </div>
                <div class="modal-body">
                    <!-- ✅ MEJORA: Mensaje más claro y centrado en los beneficios reales. -->
                    <i class="fas fa-lock auth-prompt-icon"></i>
                    <p class="auth-prompt-main-text">Para acceder a este contenido, necesitas una cuenta.</p>
                    <div class="auth-prompt-benefits">
                        <p>Al registrarte, desbloquearás:</p>
                        <ul>
                            <li><i class="fas fa-book-open"></i> Acceso a toda la <strong>biblioteca de
                                    materiales</strong>
                                y PDFs.</li>
                            <li><i class="fas fa-robot"></i> Uso del <strong>Tutor IA</strong> como guía para tus
                                consultas
                                académicas.</li>
                        </ul>
                    </div>
                </div>
                <div class="modal-footer">
                    <a href="/register.html" class="btn-secondary">Registrarse Ahora</a>
                    <a href="/login.html" class="btn-primary">Iniciar Sesión</a>
                </div>
            </div>
        </div>

        <!-- ✅ NUEVO: Modal para filtros en móvil -->
        <div id="filter-modal" class="modal filter-modal modal-overlay" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Filtrar Resultados</h2>
                    <button class="modal-close-btn filter-modal-close modal-close">×</button>
                </div>
                <div class="modal-body" id="filter-modal-body"></div>
            </div>
        </div>

        <!-- ✅ NUEVO: Modal de Confirmación Genérico -->
        <div id="confirmation-modal" class="modal modal-overlay" style="display: none; z-index: 2000;">
            <div class="modal-content" style="max-width: 400px;">
                <div class="modal-header">
                    <h2 id="confirmation-modal-title">Confirmación</h2>
                    <button class="modal-close-btn modal-close">×</button>
                </div>
                <div class="modal-body">
                    <p id="confirmation-modal-message">¿Estás seguro de realizar esta acción?</p>
                </div>
                <div class="modal-footer">
                    <button id="confirmation-modal-cancel" class="btn-secondary">Cancelar</button>
                    <button id="confirmation-modal-confirm" class="btn-primary">Confirmar</button>
                </div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

        <!-- ✅ CORRECCIÓN CRÍTICA: Cargar scripts en el orden correcto y app.js al final -->
        <script src="js/config.js"></script> <!-- ✅ NUEVO: Configuración global antes de todo -->

        <script src="js/ui/components.js"></script> <!-- Componentes de UI primero -->
        <script src="js/services/authApiService.js"></script> <!-- Servicio de API de Auth -->
        <script src="js/services/analyticsApiService.js"></script> <!-- ✅ NUEVO: Servicio de API de Analytics -->
        <script src="js/sessionManager.js"></script> <!-- Gestor de sesión -->
        <script src="js/ui/uiManager.js"></script> <!-- ✅ NUEVO: Gestor de UI y Bloqueo Soft -->
        <script src="js/search.js"></script> <!-- Lógica de búsqueda -->
        <script src="js/chat.js"></script> <!-- Lógica del chat -->
        <script src="js/ui/confirmationModal.js"></script> <!-- ✅ NUEVO: Modal de confirmación -->
        <script src="js/ui/citationManager.js"></script> <!-- ✅ NUEVO: Gestor de Citación -->
        <script src="js/library.js"></script> <!-- ✅ NUEVO: Gestor de Biblioteca (Favoritos/Guardados) -->
        <script src="js/security.js"></script> <!-- ✅ NUEVO: Escudo de Seguridad -->
        <script src="js/app.js"></script> <!-- Archivo principal de inicialización, al final -->

</body>

</html>